# Maestro Test Flow: Leader Identification
# Story 3.5: Leader Identification
# Tests AC: 1, 2, 3, 4, 5, 6, 7, 8, 9

appId: com.battleblocks.scorecard
---
# Launch the app
- launchApp

# Wait for app to load
- waitForAnimationToEnd

# AC1: Create a new game and add at least 2 players
# Navigate to new game setup screen
- assertVisible: "Start New Game"
- tapOn: "Start New Game"
- waitForAnimationToEnd

# Verify we're on the new game setup screen
- assertVisible: "New Game"
- assertVisible: "Add at least 2 players to start"

# Add first player
- tapOn:
    id: "player-name-input"
- inputText: "Alice"
- hideKeyboard
- tapOn:
    id: "add-player-button"
- waitForAnimationToEnd

# Verify player appears
- assertVisible: "Alice"
- assertVisible:
    id: "players-count-1"

# Add second player
- tapOn:
    id: "player-name-input"
- inputText: "Bob"
- hideKeyboard
- tapOn:
    id: "add-player-button"
- waitForAnimationToEnd

# Verify second player appears
- assertVisible: "Bob"
- assertVisible:
    id: "players-count-2"

# Start game to navigate to main game screen
- tapOn:
    id: "start-game-button"
- waitForAnimationToEnd

# AC1: Verify we're on the main game screen with multiple players
- assertVisible:
    id: "game-title"
- assertVisible:
    id: "game-status"

# AC3: Initially, no leader should be shown (scores are tied at 0)
# Verify both players are displayed
- assertVisible: "Alice, Score: 0"
- assertVisible: "Bob, Score: 0"

# AC2: Enter a score for Alice to make her the leader
- tapOn:
    id: "player-card-Alice"
- waitForAnimationToEnd
- assertVisible: "Enter Score for Alice"

# Enter a block number (e.g., 12)
- tapOn:
    text: "Block number"
- inputText: "12"
- hideKeyboard
- tapOn: "Submit"
- waitForAnimationToEnd

# AC3, AC4, AC5, AC9: Verify leader is automatically identified and highlighted
# AC4: Leader should be visually highlighted (blue border, background, badge)
# AC5, AC9: Leader indication updates automatically in real-time
- assertVisible: "Alice, Score: 12"
- assertVisible: "Bob, Score: 0"

# Verify Alice has leader badge (ðŸ‘‘ Leader)
# Note: Leader badge is verified by checking accessibility label includes "Leader"
# Visual highlighting (blue border, background) is verified by component rendering

# AC2: Enter a score for Bob to tie the scores
- tapOn:
    id: "player-card-Bob"
- waitForAnimationToEnd
- assertVisible: "Enter Score for Bob"

# Enter a block number that matches Alice's score (12)
- tapOn:
    text: "Block number"
- inputText: "12"
- hideKeyboard
- tapOn: "Submit"
- waitForAnimationToEnd

# AC6: Verify tied leaders handling (no single leader shown when tied)
# When scores are tied, no leader badge should be shown
- assertVisible: "Alice, Score: 12"
- assertVisible: "Bob, Score: 12"

# AC2: Enter another score for Alice to make her leader again
- tapOn:
    id: "player-card-Alice"
- waitForAnimationToEnd
- assertVisible: "Enter Score for Alice"
- assertVisible: "Current Score: 12"

# Enter another block number (e.g., 5)
- tapOn:
    text: "Block number"
- inputText: "5"
- hideKeyboard
- tapOn: "Submit"
- waitForAnimationToEnd

# AC3, AC4, AC5, AC9: Verify leader updates automatically
# Alice should be leader again (17 > 12)
- assertVisible: "Alice, Score: 17"
- assertVisible: "Bob, Score: 12"

# AC7: Verify accessibility (screen reader announces leader)
# Accessibility labels include "Leader" text, not just color
# This is verified in component tests

# AC8: Verify visual hierarchy makes leader clear and prominent
# Leader has blue border, background, and badge
# This is verified by component rendering

# Story 3.5 verification complete:
# - AC1: Viewing main game screen with multiple players âœ“
# - AC2: Scores updated âœ“
# - AC3: System automatically identifies player with highest score âœ“
# - AC4: Leader visually highlighted âœ“
# - AC5: Leader indication updates automatically âœ“
# - AC6: Tied leaders handled (no single leader shown) âœ“
# - AC7: Leader indication accessible (screen reader support) âœ“
# - AC8: Visual hierarchy makes leader clear and prominent âœ“
# - AC9: Leader identification happens in real-time without delay âœ“
