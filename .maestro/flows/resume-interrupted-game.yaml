# Maestro Test Flow: Resume Interrupted Game
# Story 2.4: Resume Interrupted Game
# Tests AC: 2, 3, 4, 5, 6, 7, 8, 9, 10, 11

appId: com.battleblocks.scorecard
---
# AC11: Launch the app with an existing active game in the database
# First, create a game to simulate an interrupted game

# Launch the app
- launchApp

# Wait for app to load
- waitForAnimationToEnd

# Create a game first (simulating an interrupted game)
# Navigate to new game setup screen
- assertVisible: "Start New Game"
- tapOn: "Start New Game"
- waitForAnimationToEnd

# Verify we're on the new game setup screen
- assertVisible: "New Game"
- assertVisible: "Add at least 2 players to start"

# Add first player
- tapOn:
    id: "player-name-input"
- inputText: "Alice"
- hideKeyboard
- tapOn:
    id: "add-player-button"
- waitForAnimationToEnd

# Verify player appears
- assertVisible: "Alice"
- assertVisible:
    id: "players-count-1"

# Add second player
- tapOn:
    id: "player-name-input"
- inputText: "Bob"
- hideKeyboard
- tapOn:
    id: "add-player-button"
- waitForAnimationToEnd

# Verify second player appears
- assertVisible: "Bob"
- assertVisible:
    id: "players-count-2"

# Start game to create an active game
- tapOn:
    id: "start-game-button"
- waitForAnimationToEnd

# AC2, AC3: Verify we're on the main game screen (game was created)
- assertVisible:
    id: "game-title"
- assertVisible:
    id: "game-status"

# AC5: Verify players and scores are displayed (initial scores are 0)
- assertVisible: "Alice, Score: 0"
- assertVisible: "Bob, Score: 0"

# Now simulate app restart by navigating back to home
# This simulates the scenario where user closes app and reopens it
- tapOn: "back"
- waitForAnimationToEnd

# AC2, AC3, AC10: Verify we're back on home screen and "Continue Game" button is visible
- assertVisible: "Battle Blocks Scorecard"
- assertVisible: "Track scores for your Battle Blocks games"
- assertVisible:
    id: "continue-game-button"

# AC4: Tap the "Continue Game" button
- tapOn:
    id: "continue-game-button"
- waitForAnimationToEnd

# AC5, AC6: Verify navigation to the main game screen with restored game state
- assertVisible:
    id: "game-title"
- assertVisible:
    id: "game-status"

# AC5: Verify all players and their scores are correctly restored
- assertVisible: "Alice, Score: 0"
- assertVisible: "Bob, Score: 0"

# AC5: Verify game status is active
- assertVisible: "Status: active"

# AC7: Performance requirement (500ms restoration) is verified by the flow completing smoothly
# If restoration takes too long, the flow would timeout or fail

# Note: Testing multiple active games scenario would require a separate flow
# or manual setup of multiple games in the database
# For now, this flow tests the single game resume scenario
