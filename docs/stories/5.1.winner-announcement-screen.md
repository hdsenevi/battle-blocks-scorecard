# Story 5.1: Winner Announcement Screen

## Status
Draft

## Story

**As a** user,
**I want** to see a winner announcement when a player reaches exactly 50 points,
**so that** I know the game is complete and who won.

## Acceptance Criteria

1. **Given** a player reaches exactly 50 points (Story 4.3)
2. **When** the win condition is detected
3. **Then** the winner announcement screen is displayed:
   - Large, prominent display of the winner's name
   - "Winner!" or "Game Over!" message
   - Celebration visual elements (e.g., confetti, success colors)
4. **And** the screen appears automatically without user action
5. **And** success haptic feedback is triggered (triggerCompletion() from Story 1.5)
6. **And** the game status is marked as "completed" in the database
7. **And** the game is saved as a completed game (FR27, FR44)
8. **And** the UI transition is smooth (< 200ms per NFR2)
9. **And** the celebration is accessible (screen reader announces winner)

**FRs covered:** FR41, FR42, FR44, FR36, NFR2, NFR40

## Tasks / Subtasks

- [ ] Create winner announcement screen (AC: 3)
  - [ ] Create `app/game/[id]/winner.tsx` screen
  - [ ] Display winner's name prominently
  - [ ] Display "Winner!" or "Game Over!" message
  - [ ] Add celebration visual elements
- [ ] Implement automatic navigation (AC: 2, 4)
  - [ ] Navigate to winner screen when win detected
  - [ ] Pass winner information
  - [ ] Ensure automatic transition
- [ ] Trigger haptic feedback (AC: 5)
  - [ ] Call triggerCompletion() from haptics service
  - [ ] Ensure haptic completes within 50ms
- [ ] Mark game as completed (AC: 6, 7)
  - [ ] Update game status to "completed" in database
  - [ ] Use database service updateGame()
  - [ ] Save game as completed
- [ ] Update game state (AC: 6)
  - [ ] Update GameContext with completed status
  - [ ] Dispatch COMPLETE_GAME action
- [ ] Ensure smooth transition (AC: 8)
  - [ ] UI transition < 200ms
  - [ ] Smooth animation
- [ ] Implement accessibility (AC: 9)
  - [ ] Screen reader announces winner
  - [ ] Proper semantic labels
  - [ ] Accessible celebration elements

## Dev Notes

### Project Context
This story implements the winner announcement screen, providing a satisfying conclusion to the game when a player wins.

### Source Tree Information
- **Winner screen**: `app/game/[id]/winner.tsx` - Winner announcement screen
- **Haptics service**: `services/haptics.ts` - triggerCompletion() function
- **Database service**: `services/database.ts` - updateGame() function
- **Game Context**: `contexts/GameContext.tsx` - COMPLETE_GAME action
- **Game Reducer**: `reducers/gameReducer.ts` - Handles COMPLETE_GAME action

### Architecture References
- **Navigation**: Automatic navigation to winner screen
- **Haptics**: Success pattern haptic for completion
- **Game Status**: Mark game as "completed"
- **Performance**: UI transition < 200ms (NFR2)
- **Accessibility**: Screen reader support

### Dependencies
- Requires Story 4.3 (Win Condition Detection) to be completed
- Requires Story 1.5 (Haptics Service) to be completed
- Requires Story 1.3 (Database Service) to be completed
- Requires Story 1.6 (Game Context) to be completed

### Testing

**Test File Location:**
- `app/__tests__/game/[id]/winner.test.tsx` - Winner screen tests

**Test Standards:**
- Test winner screen display
- Test automatic navigation
- Test haptic feedback
- Test game completion marking
- Test UI transition performance
- Test accessibility
- Mock haptics and database services

**Testing Frameworks:**
- Jest for unit testing
- React Native Testing Library for component testing

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-14 | 1.0 | Story created from Epic 5 | PM Agent |

## Dev Agent Record

### Agent Model Used
_To be populated by Dev Agent_

### Debug Log References
_To be populated by Dev Agent_

### Completion Notes List
_To be populated by Dev Agent_

### File List
_To be populated by Dev Agent_

## QA Results
_To be populated by QA Agent_
