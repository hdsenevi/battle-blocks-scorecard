# Story 3.5: Leader Identification

## Status
Draft

## Story

**As a** user,
**I want** to see which player is currently leading the game,
**so that** I know who is winning at any moment.

## Acceptance Criteria

1. **Given** I am viewing the main game screen with multiple players
2. **When** scores are updated (Story 3.4)
3. **Then** the system automatically identifies the player with the highest score
4. **And** the leader is visually highlighted (e.g., blue accent, border, or background)
5. **And** the leader indication updates automatically when scores change
6. **And** if multiple players are tied for the lead, all tied players are indicated
7. **And** the leader indication is accessible (screen reader announces leader, not just color)
8. **And** the visual hierarchy makes the leader clear and prominent
9. **And** leader identification happens in real-time without perceptible delay
10. **And** a Maestro automation test flow is created in `.maestro/flows/` that:
    - Launches the app, creates a new game, adds at least 2 players, and navigates to the main game screen
    - Enters scores for different players to create a leader
    - Verifies the player with the highest score is visually highlighted as the leader
    - Updates scores to change the leader
    - Verifies the leader indication updates automatically when scores change
    - Verifies tied leaders are indicated when multiple players have the same highest score
    - Verifies leader identification happens in real-time without perceptible delay
    - The test flow is added to the automation regression suite

**FRs covered:** FR12, FR38, NFR40, NFR41

## Tasks / Subtasks

- [ ] Implement leader calculation logic (AC: 3)
  - [ ] Calculate highest score from all players
  - [ ] Identify player(s) with highest score
  - [ ] Handle ties (multiple leaders)
- [ ] Implement visual highlighting (AC: 4, 8)
  - [ ] Add visual indicator (blue accent, border, background)
  - [ ] Make leader prominent in visual hierarchy
  - [ ] Follow design system for highlighting
- [ ] Update leader indication automatically (AC: 5, 9)
  - [ ] Update when scores change
  - [ ] Ensure real-time updates without delay
  - [ ] Subscribe to GameContext score changes
- [ ] Handle tied leaders (AC: 6)
  - [ ] Identify all players with highest score
  - [ ] Highlight all tied players
  - [ ] Make tie indication clear
- [ ] Implement accessibility (AC: 7)
  - [ ] Screen reader announces leader status
  - [ ] Don't rely solely on color
  - [ ] Use icons, text, or patterns in addition to color
  - [ ] Test with screen readers

## Dev Notes

### Project Context
This story implements leader identification, showing which player is currently winning. This is a key feature for competitive gameplay.

### Source Tree Information
- **Main game screen**: `app/game/[id]/index.tsx` - Where leader is displayed
- **Player card component**: `components/game/PlayerCard.tsx` - Modified to show leader highlighting
- **Game Context**: `contexts/GameContext.tsx` - Source of score data for leader calculation

### Architecture References
- **Real-time Updates**: Updates automatically when scores change
- **Accessibility**: Screen reader support, not just color-based
- **Visual Hierarchy**: Leader must be prominent and clear
- **Ties**: Handle multiple players tied for lead

### Dependencies
- Requires Story 2.3 (Main Game Screen) to be completed
- Requires Story 3.4 (Real-Time Score Display) to be completed
- Requires Story 1.6 (Game Context) to be completed

### Testing

**Test File Location:**
- `app/__tests__/game/[id]/index.test.tsx` - Leader identification tests
- `components/game/__tests__/PlayerCard.test.tsx` - Leader highlighting tests

**Test Standards:**
- Test leader calculation logic
- Test visual highlighting
- Test automatic updates
- Test tied leaders handling
- Test accessibility features
- Test real-time updates
- Mock GameContext

**Testing Frameworks:**
- Jest for unit testing
- React Native Testing Library for component testing

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-14 | 1.0 | Story created from Epic 3 | PM Agent |

## Dev Agent Record

### Agent Model Used
_To be populated by Dev Agent_

### Debug Log References
_To be populated by Dev Agent_

### Completion Notes List
_To be populated by Dev Agent_

### File List
_To be populated by Dev Agent_

## QA Results
_To be populated by QA Agent_
