# Story 3.4: Real-Time Score Display

## Status
Draft

## Story

**As a** user,
**I want** to see current scores for all players update in real-time,
**so that** I always know the current game state.

## Acceptance Criteria

1. **Given** I am viewing the main game screen
2. **When** a score is entered for any player (Stories 3.2, 3.3)
3. **Then** all players' scores are displayed simultaneously
4. **And** score updates appear instantly (< 100ms per NFR1)
5. **And** the display updates in real-time without page refresh
6. **And** scores are displayed prominently with large, readable numbers
7. **And** the UI feels responsive with no lag or freezing (NFR6)
8. **And** score calculations are mathematically correct (NFR23)
9. **And** the display follows the design system (proper typography, spacing, contrast)
10. **And** a Maestro automation test flow is created in `.maestro/flows/` that:
    - Launches the app, creates a new game, adds at least 2 players, and navigates to the main game screen
    - Enters scores for multiple players
    - Verifies all players' scores are displayed simultaneously
    - Verifies score updates appear instantly (< 100ms)
    - Verifies the display updates in real-time without page refresh
    - Verifies scores are displayed prominently with large, readable numbers
    - Verifies the UI remains responsive with no lag or freezing
    - The test flow is added to the automation regression suite

**FRs covered:** FR11, FR13, NFR1, NFR6, NFR23

## Tasks / Subtasks

- [ ] Implement real-time score subscription (AC: 3, 5)
  - [ ] Subscribe to GameContext state changes
  - [ ] Update display when scores change
  - [ ] Ensure updates happen without page refresh
- [ ] Optimize update performance (AC: 4, 7)
  - [ ] Ensure updates appear < 100ms
  - [ ] Optimize re-renders (use React.memo if needed)
  - [ ] Prevent UI lag or freezing
- [ ] Display scores prominently (AC: 6, 9)
  - [ ] Use large, readable numbers
  - [ ] Follow typography guidelines
  - [ ] Ensure proper spacing and contrast
- [ ] Verify score accuracy (AC: 8)
  - [ ] Ensure calculations are mathematically correct
  - [ ] Test edge cases
  - [ ] Verify score totals match database
- [ ] Apply design system styling (AC: 9)
  - [ ] Use NativeWind/Tailwind classes
  - [ ] Follow spacing guidelines
  - [ ] Ensure proper contrast ratios

## Dev Notes

### Project Context
This story ensures scores update in real-time as they are entered. The display must be fast, accurate, and visually clear.

### Source Tree Information
- **Main game screen**: `app/game/[id]/index.tsx` - Where scores are displayed
- **Player card component**: `components/game/PlayerCard.tsx` - Individual player score display
- **Score display component**: `components/game/ScoreDisplay.tsx` - Score display component
- **Game Context**: `contexts/GameContext.tsx` - Source of score updates

### Architecture References
- **Real-time Updates**: Subscribes to GameContext state changes
- **Performance**: Updates < 100ms (NFR1), no lag (NFR6)
- **Accuracy**: Mathematically correct calculations (NFR23)
- **Design System**: Proper typography, spacing, contrast

### Dependencies
- Requires Story 2.3 (Main Game Screen) to be completed
- Requires Story 1.6 (Game Context) to be completed
- Integrates with Stories 3.2 and 3.3 (Score entry)

### Testing

**Test File Location:**
- `app/__tests__/game/[id]/index.test.tsx` - Main game screen tests
- `components/game/__tests__/ScoreDisplay.test.tsx` - Score display tests

**Test Standards:**
- Test real-time score updates
- Test update performance (< 100ms)
- Test UI responsiveness (no lag)
- Test score accuracy
- Test design system compliance
- Mock GameContext

**Testing Frameworks:**
- Jest for unit testing
- React Native Testing Library for component testing

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-14 | 1.0 | Story created from Epic 3 | PM Agent |

## Dev Agent Record

### Agent Model Used
_To be populated by Dev Agent_

### Debug Log References
_To be populated by Dev Agent_

### Completion Notes List
_To be populated by Dev Agent_

### File List
_To be populated by Dev Agent_

## QA Results
_To be populated by QA Agent_
